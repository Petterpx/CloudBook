# é‡å­¦æ•°æ®ç»“æ„-é“¾è¡¨

![image-20200830093107764](https://tva1.sinaimg.cn/large/007S8ZIlly1gi8l1hc6j0j30zq0mbmzx.jpg)

### What is a linked listï¼ŸğŸ¤”

- ä¸åŒäºæ ˆä¸é˜Ÿåˆ—åŠåŠ¨æ€æ•°ç»„ï¼Œå®ƒæ˜¯çœŸæ­£æ„ä¹‰ä¸Šæœ€ç®€å•çš„åŠ¨æ€æ•°æ®ç»“æ„ã€‚

- ä¼˜ç‚¹ï¼šçœŸæ­£çš„åŠ¨æ€ï¼Œä¸éœ€è¦å¤„ç†å›ºå®šå®¹é‡çš„é—®é¢˜

- ç¼ºç‚¹ï¼šä¸§å¤±äº†éšæœºè®¿é—®çš„èƒ½åŠ›

- æ•°æ®å­˜å‚¨åœ¨ â€œèŠ‚ç‚¹â€ï¼ˆNodeï¼‰ä¸­

  ```kotlin
  class Node(val e: E, val next: Node)
  ```



![image-20200829211246140](https://tva1.sinaimg.cn/large/007S8ZIlly1gi7zp956q5j30gw04ujrd.jpg)

### å­¦ä¹ é“¾è¡¨æˆ‘ä»¬å¯ä»¥è·å¾—å“ªäº›ï¼Ÿ

- åŠ æ·±å¼•ç”¨çš„ç†è§£ã€‚(ç±»ä¼¼Cè¯­è¨€çš„æŒ‡é’ˆ)
- é“¾è¡¨å†…éƒ¨ä¹Ÿæœ‰é€’å½’ç»“æ„çš„æ€§è´¨
- ä¾¿äºå¯¹å…¶ä»–æ•°æ®ç»“æ„çš„è¾…åŠ©



### å®ç°å•å‘é“¾è¡¨

å¦‚ä½•å®ç°ä¸€ä¸ªå•å‘é“¾è¡¨å‘¢ï¼Ÿ

> **å¾ˆç®€å•ï¼Œé“¾è¡¨ä¸åƒæ•°ç»„é‚£æ ·ï¼Œä¸éœ€è¦æˆ‘ä»¬ä¸»åŠ¨æ‰©å®¹ï¼Œæˆ‘ä»¬åªéœ€è¦ç±»ä¼¼é€’å½’ä¸€æ ·ï¼Œä¸€å±‚å¥—ä¸€å±‚å³å¯ï¼Œå³node1æŒæœ‰node2çš„å¼•ç”¨ï¼Œnode2æŒæœ‰node3....ï¼Œç›¸åº”çš„æ¯æ¬¡æ’å…¥æˆ‘ä»¬åªéœ€è¦æ›´æ”¹å¤´ç»“ç‚¹å³å¯ï¼Œå½“node-xæŒæœ‰çš„ä¸‹ä¸€ä¸ªnodeå¼•ç”¨ä¸ºnullæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ¤å®šï¼Œæ­¤æ—¶ä¸ºé“¾è¡¨å°¾èŠ‚ç‚¹ã€‚**

```kotlin
class LinkedList<E> {
    private var size = 0
  	//å¤´ç»“ç‚¹
    private var head: Node<E>? = null

    private class Node<E>(var e: E? = null, var next: Node<E>? = null) {
        override fun toString(): String {
            return e?.toString() ?: ""
        }
    }


    fun addFirst(e: E) {
//        val node = Node(e)
//        node.next = head
//        head = node
        //ç®€åŒ–ç‰ˆæ·»åŠ é¦–å…ƒç´ 
        head = Node(e, head)
        ++size
    }
    

    /** ç§»é™¤å¤´èŠ‚ç‚¹å…ƒç´  O(1) */
    fun removeFirst() {
        if (head == null) throw RuntimeException("nodeFirst != null!!")
        val node = head?.next
        head?.e = null
        head = node
        --size
    }

    /** åœ¨é“¾è¡¨æŒ‡å®šä½ç½®æ·»åŠ å…ƒç´  */
    fun addIndexed(index: Int, e: E) {
        if (index > size || index < 0) throw RuntimeException("æŒ‡å®šä½ç½®é•¿åº¦ä¸å¾—è¶…è¿‡ç°æœ‰é“¾è¡¨é•¿åº¦")
        if (size == 0) {
            addFirst(e)
        } else {
            var node = head
            var sum = 0
            while (node != null) {
                if (sum++ == index - 1) {
                    node.next = Node(e, node.next)
                    ++size
                    return
                }
                node = node.next
            }
        }
    }

    /** å°¾ç»“ç‚¹æ·»åŠ  */
    fun addLast(e: E) {
        addIndexed(size, e)
    }

    /** è¿”å›é“¾è¡¨æ˜¯å¦ä¸ºnull  */
    private fun isEmpty(): Boolean {
        return size == 0
    }

    override fun toString(): String {
        val stringBuilder = StringBuilder("å¼€å§‹--- [")
        if (head?.e != null)
            stringBuilder.append("${head?.e},")
        var next = head?.next
        while (next != null) {
            stringBuilder.append("${next.e},")
            next = next.next
        }
        if (head?.e != null) {
            stringBuilder.deleteCharAt(stringBuilder.length - 1)
        }
        return stringBuilder.append("]--- ç»“æŸ").toString()
    }
}
```



### ä¸ºé“¾è¡¨å¢åŠ å¢åˆ æ”¹æŸ¥

åœ¨ä¸Šè¿°çš„å®ç°é‡Œï¼Œæˆ‘ä»¬åœ¨æ·»åŠ èŠ‚ç‚¹æ—¶ï¼Œæ¯æ¬¡éƒ½éœ€è¦è€ƒè™‘é“¾è¡¨ä¸ºnullçš„æƒ…å†µï¼Œå¯¹äºè¿™ç§çŠ¶æ€ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘å¼•å…¥ä¸€ä¸ªè™šæ‹ŸèŠ‚ç‚¹ï¼Œè¿™æ ·æˆ‘ä»¬æ¯æ¬¡éå†æ·»åŠ æ—¶å°±å¯ä»¥ä¸ç”¨ index-1ï¼Œå³æ— éœ€è€ƒè™‘å‰ä¸€ä¸ªèŠ‚ç‚¹çš„æƒ…å†µï¼Œè€Œä¸”æˆ‘ä»¬è¿˜å¯ä»¥è€ƒè™‘åŠ å…¥ **åˆ é™¤ï¼Œä¿®æ”¹ï¼Œå’Œæ ¹æ®ä½ç½®æŸ¥æ‰¾**ã€‚

```kotlin
class LinkedList<E> {
    private var size = 0

    //è™šæ‹Ÿå¤´ç»“ç‚¹
    private var dummyHead: Node<E> = Node(null, null)

    private class Node<E>(var e: E? = null, var next: Node<E>? = null) {
        override fun toString(): String {
            return e?.toString() ?: ""
        }
    }
    
    /** æ·»åŠ é“¾è¡¨å¤´å…ƒç´  */
    fun addFirst(e: E) {
        addIndexed(0, e)
    }

    /** ç§»é™¤é“¾è¡¨å¤´ O(1)*/
    fun removeFirst(): E? {
        return removeIndexed(0)
    }

    /** ç§»é™¤é“¾è¡¨å°¾ 0(n) */
    fun removeLast(): E? {
        return removeIndexed(size - 1)
    }

    /** åˆ é™¤æŒ‡å®šä½ç½®ä¸‹æ ‡å…ƒç´  */
    fun removeIndexed(index: Int): E? {
        if (index > size || index < 0) throw RuntimeException("æŒ‡å®šä½ç½®é•¿åº¦ä¸å¾—è¶…è¿‡ç°æœ‰é“¾è¡¨é•¿åº¦")
        var node = dummyHead
        //æ‰¾åˆ°å¾…åˆ é™¤èŠ‚ç‚¹ä¹‹å‰çš„èŠ‚ç‚¹
        (0 until index).forEach { _ ->
            node.next?.let {
                node = it
            }
        }
        val retNode = node.next
        node.next = retNode?.next
        retNode?.next = null
        --size
        return retNode?.e
    }


    /** åœ¨é“¾è¡¨æŒ‡å®šä½ç½®æ·»åŠ å…ƒç´  */
    fun addIndexed(index: Int, e: E) {
        if (index > size || index < 0) throw RuntimeException("æŒ‡å®šä½ç½®é•¿åº¦ä¸å¾—è¶…è¿‡ç°æœ‰é“¾è¡¨é•¿åº¦")
        var node = dummyHead
        (0 until index).forEach { _ ->
            node.next?.let {
                node = it
            }
        }
        node.next = Node(e, node.next)
        ++size
        return
    }

    /** å°¾ç»“ç‚¹æ·»åŠ  */
    fun addLast(e: E) {
        addIndexed(size, e)
    }

    /** è¿”å›é“¾è¡¨æ˜¯å¦ä¸ºnull  */
    fun isEmpty(): Boolean {
        return size == 0
    }
    
    /** è·å–æŒ‡å®šä½ç½®å…ƒç´  */
    fun get(index: Int): E? {
        if (index > size || index < 0) throw RuntimeException("æŒ‡å®šä½ç½®é•¿åº¦ä¸å¾—è¶…è¿‡ç°æœ‰é“¾è¡¨é•¿åº¦")
        var cur = dummyHead.next
        (0 until index).forEach { _ ->
            cur = cur?.next
        }
        return cur?.e
    }

    /** è·å–é¦–å…ƒç´  */
    fun getFirst(): E {
        return get(0)
    }

    /** è·å–å°¾å…ƒç´  */
    fun getLast(): E {
        return get(size - 1)
    }

    /** æ›´æ–°æŒ‡å®šä½ç½®e */
    fun set(index: Int, e: E) {
        if (index > size || index < 0) throw RuntimeException("æŒ‡å®šä½ç½®é•¿åº¦ä¸å¾—è¶…è¿‡ç°æœ‰é“¾è¡¨é•¿åº¦")
        var node = dummyHead.next
        (0 until index).forEach { _ ->
            node = node?.next
        }
        node?.e = e
    }

    /** åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŒ‡å®šå…ƒç´  */
    fun contains(e: E): Boolean {
        var node = dummyHead.next
        while (node != null) {
            if (node.e === e)
                return true
            node = node.next
        }
        return false
    }

    override fun toString(): String {
        val stringBuilder = StringBuilder("å¼€å§‹--- [")
        var next = dummyHead.next
        while (next != null) {
            stringBuilder.append("${next.e},")
            next = next.next
        }
        if (size > 0) {
            stringBuilder.deleteCharAt(stringBuilder.length - 1)
        }
        return stringBuilder.append("]--- ç»“æŸ").toString()
    }
}
```

 

### é“¾è¡¨å¤æ‚åº¦åˆ†æ

- **å¢ O(n)** 				
- **åˆ  O(n)**                
- **æ”¹ O(n)**
- **æŸ¥ O(n)**

> ***ä¸Šè¿°å¦‚æœéƒ½æ˜¯å¯¹äºé“¾è¡¨å¤´è¿›è¡Œæ“ä½œï¼Œé‚£ä¹ˆç›¸åº”çš„æ•ˆç‡éƒ½ä¸ºO(1)***



### ä½¿ç”¨é“¾è¡¨å®ç°æ ˆ

ä½¿ç”¨é“¾è¡¨å®ç°æ ˆéå¸¸ç®€å•ï¼Œå› ä¸ºæ ˆæ˜¯å…ˆè¿›åå‡ºï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥å¯ä»¥åˆ©ç”¨é“¾è¡¨å®ç°ï¼Œè€Œä¸”ç›¸åº”çš„æ•ˆç‡éƒ½ä¸ºO(1) ,**æ­¤æ—¶æŒ‡çš„åªæ˜¯ç§»é™¤æ ˆåº•ï¼Œæ·»åŠ è¡¨å¤´å…ƒç´ **ã€‚

```kotlin
interface Stack<E> {
    fun getSize(): Int
    fun isEmpty(): Boolean
    fun pop(): E?
    fun peek(): E?
    fun push(e: E)
}

class LinkedListStack<E> : Stack<E> {

    private val linkedList by lazy {
        LinkedList<E>()
    }

    override fun getSize(): Int {
        return linkedList.getSize()
    }

    override fun isEmpty(): Boolean {
        return linkedList.isEmpty()
    }

    override fun pop(): E? {
        return linkedList.removeFirst()
    }

    override fun peek(): E {
        return linkedList.getFirst()
    }

    override fun toString(): String {
        val res = StringBuilder()
        res.append("Stack:Pop-")
        res.append(linkedList)
        return res.toString()

    }

    override fun push(e: E) {
        linkedList.addFirst(e)
    }
}
```





### ä½¿ç”¨é“¾è¡¨å®ç°é˜Ÿåˆ—(å¸¦æœ‰å°¾æŒ‡é’ˆçš„é“¾è¡¨)

å¯¹äºé“¾è¡¨æ¥è¯´ï¼Œå› ä¸ºæˆ‘ä»¬æœ‰headè¿™æ ·çš„å¤´æŒ‡é’ˆï¼Œæ‰€ä»¥å¯¹äºè¡¨å¤´çš„æ’å…¥å’Œåˆ é™¤éƒ½æ˜¯éå¸¸å®¹æ˜“ï¼Œå¦‚æœæˆ‘ä»¬è¦ä½¿ç”¨é“¾è¡¨å®ç°é˜Ÿåˆ—ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦å†å¢åŠ ä¸€ä¸ªtailå°¾æŒ‡é’ˆ(å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæ ‡è®°)å³å¯ã€‚

![image-20200829211503994](https://tva1.sinaimg.cn/large/007S8ZIlly1gi7zrm1lsoj30k206cwel.jpg)

#### è¾¹ç•Œè€ƒè™‘

- å½“tail ä¸ºnull,é‚£ä¹ˆå°±è¯æ˜é“¾è¡¨æ­¤æ—¶ä¸ºnull,æ‰€ä»¥æ­¤æ—¶æˆ‘ä»¬éœ€è¦åˆå§‹åŒ–tailèŠ‚ç‚¹ï¼Œå¹¶ç›¸åº”çš„é‡ç½®headæŒ‡é’ˆ
- å½“æˆ‘ä»¬ç§»é™¤å…ƒç´ æ—¶ï¼Œå¦‚æœheadä¸ºnull,åˆ™é“¾è¡¨æ­¤æ—¶ä¸ºnull,åŒæ ·éœ€è¦æ›´æ–°tailæŒ‡é’ˆ

```kotlin
interface Queue<E> {
    fun enqueue(e: E)
    fun dequeue(): E?
    fun getFront(): E?
    fun getSize(): Int
    fun isEmpty(): Boolean
}

class LinkedListQueue<E> : Queue<E> {

    private var size = 0
    private var head: Node<E>? = null
    private var tail: Node<E>? = null

    private class Node<E>(var e: E? = null, var next: Node<E>? = null) {
        override fun toString(): String {
            return e?.toString() ?: ""
        }
    }

    override fun enqueue(e: E) {
        tail?.let {
            tail?.next = Node(e)
            tail = tail?.next
        } ?: tailNull(e)
        ++size
    }

    private fun tailNull(e: E) {
        tail = Node(e)
        head = tail
    }

    override fun dequeue(): E? {
        if (head == null) throw NullPointerException("head !=null!!")
        val node = head
        head = head?.next
        node?.next = null
        --size
        if (head == null) tail = null
        return node?.e
    }

    override fun getFront(): E? {
        if (head == null) throw NullPointerException("head !=null!!")
        return head?.e
    }

    override fun getSize(): Int {
        return size
    }

    override fun isEmpty(): Boolean {
        return size == 0
    }

    override fun toString(): String {
        val stringBuilder = StringBuilder("å¼€å§‹--- [")
        var next = head
        while (next != null) {
            stringBuilder.append("${next.e},")
            next = next.next
        }
        if (size > 0) {
            stringBuilder.deleteCharAt(stringBuilder.length - 1)
        }
        return stringBuilder.append("]--- ç»“æŸ").toString()
    }
}
```









å‚è€ƒè§†é¢‘ï¼š[æ…•è¯¾ç½‘liuyubobobo](https://www.imooc.com/t/108955)




> æˆ‘æ˜¯ *Petterp* ,å¦‚æœä½ è§‰å¾—æˆ‘çš„æ–‡ç« å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œæ¬¢è¿ç‚¹èµğŸ‘    ï¼Œå¦‚æœæœ‰ä»»ä½•æƒ³æ³•å’Œé—®é¢˜ï¼Œéšæ—¶æ¬¢è¿è¯„è®ºåŒºä¸€èµ·è®¨è®ºã€‚ğŸ‘¨â€ğŸ’»â€