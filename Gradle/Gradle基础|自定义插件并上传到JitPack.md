# GradleåŸºç¡€|è‡ªå®šä¹‰æ’ä»¶å¹¶ä¸Šä¼ åˆ°JitPack

![gradle](https://tva1.sinaimg.cn/large/008i3skNly1gz5u056f47j30zk0hs0ta.jpg)

> ã€Œ**2022 å¹´ä»€ä¹ˆä¼šç«ï¼Ÿä»€ä¹ˆè¯¥å­¦ï¼Ÿæœ¬æ–‡æ­£åœ¨å‚ä¸[â€œèŠèŠ 2022 æŠ€æœ¯è¶‹åŠ¿â€](https://juejin.cn/post/7049621519219195918)å¾æ–‡æ´»åŠ¨** ã€



HiğŸ‘‹ğŸ» ï¼Œå¾ˆé«˜å…´è§åˆ°ä½ ï¼

å¼€å‘ä¸¤å¹´äº†ï¼Œæˆ‘æƒ³è®¤çœŸå­¦ä¸€ä¸‹Gradle,è¿™æ˜¯æˆ‘çš„2022æŠ€æœ¯è¿›é˜¶è®¡åˆ’ï¼ŒGradleç³»åˆ—çš„ç¬¬äºŒç¯‡ï¼Œå¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚

## å¼•è¨€

æ¯ä¸€ä¸ªä½¿ç”¨ `Gradle` çš„åŒå­¦ï¼Œè‚¯å®šéƒ½å¬è¿‡æˆ–è€…å†™è¿‡æ’ä»¶ï¼Œå› ä¸ºå…¶æœ¬èº«å¹¶ä¸éš¾ï¼Œä½†ç¢äºç°åœ¨ç½‘ä¸Šçš„æ–‡ç« åƒç¯‡ä¸€å¾‹ï¼Œå¤§éƒ¨åˆ†éƒ½æ¯”è¾ƒè€ï¼Œæ–°åŒå­¦ä¸€ä¸Šæ‰‹åè€Œæ˜¯å’Œæˆ‘ä¸€æ ·ï¼ŒèŠ±äº†å¤§æŠŠæ—¶é—´åœ¨æœ€åŸºç¡€çš„ç¬¬ä¸€æ­¥å¦‚ä½•å†™ä¸€ä¸ªç®€å•demoä¸Šã€‚å†è€…å¦‚æœå¤§å®¶ä½¿ç”¨ **AndroidStudio BumBlebee** å»åˆ›å»ºé¡¹ç›®ï¼Œé‚£å¯¹ç…§ç½‘ä¸Šæ•™ç¨‹å·®åˆ«æ›´å¤§ï¼Œç”šæ˜¯èŠ±è´¹æ—¶é—´ï¼Œè€Œæœ¬ç¯‡å°±æ˜¯å¸®ä½ çœæ‰è¿™äº›æ—¶é—´ã€‚

æœ¬ç¯‡ä¸»è¦æ¦‚æ‹¬åˆ›å»ºæ’ä»¶çš„ä¸‰ç§æ–¹å¼ï¼Œå¹¶å¦‚ä½•ä¸Šä¼ åˆ° `JitPack` ä¸­ã€‚

> - å¼€å‘ç¯å¢ƒåŸºäºæœ€æ–°çš„ **Gradle7.0.4** , **AndroidStudio BumBlebee** ï¼›
> - æœ¬æ–‡ç›¸å…³ç¤ºä¾‹ä»£ç ,[github](https://github.com/Petterpx/GradlePluginSImple)

## 

## ä»€ä¹ˆæ˜¯æ’ä»¶ï¼Ÿ

åœ¨ `Gradle` ä¸­ï¼Œæ’ä»¶ç›¸å½“äºæ‰“åŒ…äº†å¯é‡ç”¨çš„ä¸€äº›æ„å»ºç‰‡æ®µï¼Œä½¿å…¶å¯å¤ç”¨ä¸ºå¤šä¸ªé¡¹ç›®å»æ„å»ºã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š

```groovy
// æ–°ç‰ˆå†™æ³•
plugins {
    id 'com.android.application'
}
// æ—§ç‰ˆå†™æ³•
apply plugin: 'com.android.library'
```

ä¸Šè¿°å°±æ˜¯æˆ‘ä»¬æœ€å¸¸è§çš„ä¸¤ä¸ªæ’ä»¶ï¼Œæ¯”å¦‚å½“æˆ‘ä»¬åœ¨åˆ›å»ºä¸€ä¸ª **android-model** æ—¶ï¼Œå°±ä¼šè‡ªåŠ¨æ·»åŠ ç›¸åº”çš„ `library` æ’ä»¶ï¼Œè¿™äº›æ’ä»¶çš„å·¥ä½œå°±æ˜¯å¸®æˆ‘ä»¬æŠŠä¸€äº›é‡å¤çš„å·¥ä½œæˆ–è€…ä»£ç ï¼Œä»¥ä¸€å¥ä»£ç çš„å½¢å¼å¼•å…¥ï¼Œæå¤§ç¨‹åº¦ä¸Šå‡å°‘äº†æˆ‘ä»¬çš„ä»£ç é‡ã€‚

åœ¨ `Gradle` ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `Java` ï¼Œ`Kotlin` ä»¥åŠ `Groovy` æ¥å†™è‡ªå·±çš„æ’ä»¶ï¼Œä¸€èˆ¬è€Œè¨€ï¼Œä½¿ç”¨ `Java` å’Œ `Koltin` è¦æ¯”ä½¿ç”¨ `Groovy` çš„æ‰§è¡Œæ•ˆæœä¼šæ›´å¥½ã€‚é¢˜å¤–è¯: å†™æ³•ä¸Šï¼Œ`Java` ä¸ `kotlin` ä¹Ÿæ›´ç¬¦åˆå¼€å‘ä¹ æƒ¯ã€‚

## 

## æ’ä»¶çš„ç”¨é€”æœ‰å“ªäº›ï¼Ÿ

æ’ä»¶çš„ä½œç”¨å°±æ˜¯æ·»åŠ æˆ‘ä»¬è‡ªå·±çš„ä¸€äº›é€»è¾‘åˆ°é¡¹ç›®æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œè¿™ä¸ªåšæ³•åœ¨ `Gradle` ä¸­ç§°å…¶ä¸ºä»»åŠ¡ï¼Œæˆ–è€…è¯´ `Task` ï¼Œä»è€Œå¯¹é¡¹ç›®è¿›è¡Œæµ‹è¯•ã€ç¼–è¯‘ã€æ‰“åŒ…ç­‰;

ä¹Ÿå¯ä»¥å¯¹é¡¹ç›®ä¸­ç°æœ‰çš„å¯¹è±¡ç±»å‹æ·»åŠ æ–°çš„æ‰©å±•å±æ€§ã€æ–¹æ³•ç­‰ã€ä¹Ÿå¯ä»¥é…ç½®å’Œä¼˜åŒ–é¡¹ç›®çš„æ„å»ºï¼Œæ¯”å¦‚å¸¸è§çš„ `android{}` å°±æ˜¯ `Android Gradle` æ’ä»¶ä¸º `Project` å¯¹è±¡æ·»åŠ çš„ä¸€ä¸ªæ‰©å±•ã€‚

æ—¥å¸¸å¼€å‘ä¸­ï¼Œæˆ‘ä»¬è¿˜æœ‰å¾ˆå¤šæ’ä»¶ä¼šåœ¨å¼€å‘ä¸­è§åˆ°ï¼Œæ¯”å¦‚ `didibooster` çš„æ’ä»¶ï¼Œé˜¿é‡Œè·¯ç”±æ’ä»¶ï¼Œä¸€äº›ç¬¬ä¸‰æ–¹çš„æ‰“ç‚¹æ’ä»¶ç­‰ã€‚

**æœ‰ä¸€ä¸ªæ¯”è¾ƒæœ‰æ„æ€çš„é—®é¢˜ï¼Œæˆ‘è§‰å¾—ä½ å¯èƒ½ä¼šæœ‰ï¼Ÿ** 

> `è¿™äº›æ’ä»¶ä¸€èˆ¬è¿˜è¦åœ¨modelä¸­å†ä¾èµ–å…¶ä»–ç»„ä»¶ï¼Œå¦‚æœæˆ‘åªç”¨ä»£ç ç»„ä»¶ï¼Œè€Œä¸å¯ç”¨è¿™äº›æ’ä»¶ï¼Œé‚£è¿˜èƒ½æ­£å¸¸ä½¿ç”¨å—ï¼Ÿ`
>
> å…¶å®ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸å½±å“ä½ åœ¨å¼€å‘ä¸­æ­£å¸¸ä½¿ç”¨ï¼Œä¸€ä¸ª`åˆæ ¼`çš„ä¸‰æ–¹åº“ï¼Œåœ¨æ’ä»¶æ²¡å¯ç”¨æ—¶ä¹Ÿä¸ä¼šå½±å“æœ€ç»ˆçš„ä½¿ç”¨æ•ˆæœï¼Œæ— éå°±æ˜¯æœ€ç»ˆçš„å®ç°æ–¹å¼ä¸Šä¼šæœ‰æ‰€å·®åˆ«ï¼Œæ¯”å¦‚æ€§èƒ½ä¸Šã€‚ç±»ä¼¼é˜¿é‡Œè·¯ç”±æ’ä»¶ï¼Œå¦‚æœä¸å¯ç”¨æ’ä»¶ï¼Œåªä¾èµ–ä»£ç ç»„ä»¶ä¾èµ–ï¼Œåˆ™åœ¨æœ€ç»ˆæ‰¾è·¯ç”±è¡¨æ—¶å°±åªèƒ½é€šè¿‡åå°„å»æ‰¾ï¼Œè€Œä¸æ˜¯é€šè¿‡ç¼–è¯‘æœŸé—´ç”Ÿæˆçš„è·¯å¾„æ˜ å°„ï¼Œæ‰€ä»¥ä¸€èˆ¬æˆ‘ä»¬åœ¨debugä¸‹å¯ä»¥å…³é—­æŸäº›ä¾èµ–ï¼Œä»è€Œå‡å°‘debugæ—¶é—´ï¼Œä¸è¿‡ä¸€èˆ¬è€Œè¨€ï¼Œè¿™äº›æ’ä»¶æ‰€èŠ±è´¹çš„æ—¶é—´å¹¶ä¸å¤šï¼Œæ‰€ä»¥æ ¹æ®è‡ªèº«éœ€æ±‚è€Œå®šã€‚

## 

## åˆ›å»ºæ’ä»¶æ–¹å¼

### è„šæœ¬æ’ä»¶

æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨æ„å»ºè„šæœ¬ä¸­åŒ…å«æ’ä»¶çš„æºä»£ç ï¼Œè¿™ç§æ˜¯æœ€ç®€å•æ˜“æ‡‚çš„ä¸€ç§æ–¹å¼ï¼Œå…·ä½“ç¤ºä¾‹å¦‚ä¸‹ï¼š

![image-20220208084346582](https://tva1.sinaimg.cn/large/008i3skNly1gz5t8obt06j31y20ma78w.jpg)

ç›´æ¥åœ¨ **app model** ä¸­å†™æ’ä»¶ï¼Œè¿™æ ·åšçš„å¥½å¤„å°±æ˜¯æ’ä»¶ä¼šè‡ªåŠ¨ç¼–è¯‘å¹¶åŒ…å«åœ¨æ„å»ºè„šæœ¬çš„ç±»è·¯å¾„ä¸­ï¼Œè€Œæ— éœ€åšå…¶ä»–æ“ä½œã€‚ç›¸åº”çš„ï¼Œå¦‚æœè¦è·¨é¡¹ç›®å¤ç”¨ï¼Œå°±æ¯”è¾ƒéš¾è§£å†³ï¼Œè€Œä¸”å› ä¸ºç¼ºå°‘ç»Ÿä¸€çš„ç»´æŠ¤è·¯å¾„ï¼Œä¹Ÿå¢åŠ äº†åæœŸæˆæœ¬ã€‚

---

### buildSrc

å®˜æ–¹å»ºè®®æˆ‘ä»¬å¯ä»¥å°†æœ¬åœ°æ’ä»¶çš„ä»£ç æ”¾åˆ° `buildSrc` è¿™ä¸ªç›®å½•ä¸­ã€‚è¿™ä¸ªç›®å½•æ¯”è¾ƒç‰¹æ®Šï¼Œå¯¹äºæ¯ä¸€ä¸ªå·¥ç¨‹è€Œè¨€ï¼Œæœ‰ä¸”åªèƒ½æœ‰ä¸€ä¸ª `buildSrc` ç›®å½•ï¼Œå¹¶ä¸”å¿…é¡»ä½äºé¡¹ç›®çš„æ ¹ç›®å½•ï¼Œå¦‚æœå­˜åœ¨ `buildSrc` è¿™ä¸ªç›®å½•ï¼Œé‚£ä¹ˆ `Gradle` åœ¨è¿è¡Œæ—¶ä¼šè‡ªåŠ¨ç¼–è¯‘å¹¶æµ‹è¯•è¿™é‡Œé¢çš„ä»£ç ï¼Œå¹¶å°†å…¶æ”¾å…¥æ„å»ºè„šæœ¬çš„ç±»è·¯å¾„ä¸­ï¼Œä¸ä¸Šè¿°çš„è„šæœ¬æ’ä»¶ç›¸æ¯”ï¼Œå…¶æ›´æ˜“äºç»´æŠ¤å’Œç®¡ç†æµ‹è¯•ã€‚	

> ç¤ºä¾‹ä»£ç ï¼š[buildSrc](https://github.com/Petterpx/GradlePluginSImple/tree/main/buildSrc)

ä½¿ç”¨æ•™ç¨‹:

æˆ‘ä»¬æ–°å»ºä¸€ä¸ªåä¸º `buildSrc` çš„ç›®å½•ï¼Œç„¶åç›´æ¥åˆ›å»ºä¸€ä¸ª **build.gradle** æ–‡ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤º:

![image-20220130115339054](https://tva1.sinaimg.cn/large/008i3skNly1gyvk5f6hysj31m40h0q5d.jpg)

ä»£ç å¦‚ä¸‹ï¼š

```groovy
apply plugin: 'kotlin'
buildscript {
    repositories {
        google()
        mavenCentral()
    }
    dependencies {
        // å› ä¸ºæƒ³ä½¿ç”¨kotlinï¼Œæ‰€ä»¥è¿™é‡Œå¢åŠ kotlinæ’ä»¶
        classpath "org.jetbrains.kotlin:kotlin-gradle-plugin:1.6.10-RC"
    }
}

repositories {
    google()
    mavenCentral()
}

dependencies {
    implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.10"
}
```

æ¥ç€ `sync` ä¸€ä¸‹ï¼Œç„¶åä½ å°±ä¼šå‘ç°ï¼Œè¿™ä¸ª **buildSrc** å·²ç»è¢« Android Studio è‡ªåŠ¨è¯†åˆ«ä¸ºäº†ä¸€ä¸ª **java** é¡¹ç›®ã€‚å¦‚ä¸‹ï¼š

![image-20220130120232167](https://tva1.sinaimg.cn/large/008i3skNly1gyvkenlnnej31gi0akq4m.jpg)

> å½“ç„¶ä½ ä¹Ÿå¯ä»¥ç›´æ¥åˆ›å»ºä¸€ä¸ª `java-model`,ç„¶åå»æ›´æ”¹ `build` æ–‡ä»¶,è¿™æ ·çš„å¥½å¤„æ˜¯çœå»äº†æ‰‹åŠ¨åˆ›å»ºæ–‡ä»¶å¤¹çš„åŠŸå¤«ï¼Œç›¸åº”çš„ï¼Œä½ ä¹Ÿéœ€è¦å»`settings.gradle` å»åˆ é™¤è¿™ä¸ªmodelçš„å£°æ˜ï¼ŒåŸå› æ˜¯ï¼š**buildSrcæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç›®å½•ï¼Œç¦æ­¢æ‰‹åŠ¨å£°æ˜**ï¼›

åˆ°äº†è¿™é‡Œï¼Œé‚£æˆ‘ä»¬å¦‚ä½•åˆ›å»ºè‡ªå·±çš„æ’ä»¶æ–‡ä»¶å‘¢ï¼Œç›´æ¥åœ¨ `src` ä¸‹åˆ›å»ºç›¸åº”çš„æ–‡ä»¶å¤¹å³å¯ï¼Œç„¶ååˆ›å»ºæˆ‘ä»¬è‡ªå·±çš„æ’ä»¶æ–‡ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

![image-20220130121509594](https://tva1.sinaimg.cn/large/008i3skNly1gyvkrso77hj31za0oedk1.jpg)

ä¸Šé¢çš„è¿™ä¸ªç›®å½•æ ¼å¼ï¼Œæ ¹æ®ä½ è‡ªå·±çš„å†™æ³•è€Œå®šï¼Œæ¯”å¦‚è¿™é‡Œæˆ‘æƒ³ä½¿ç”¨ `kotlin` å»å†™æ’ä»¶ä»£ç ï¼Œå°±ä½¿ç”¨å¦‚ä¸‹ï¼Œé»˜è®¤å®˜æ–¹æ¨èäº†ä¸‰ç§ç›®å½•é…ç½®å†™æ³•ï¼š

- src/main/kotlin
- src/main/java
- src/main/groovy

> psï¼š**å½“ä½¿ç”¨Asåœ¨buildSrcåˆ›å»ºç›®å½•æ—¶ï¼Œä¼šè‡ªåŠ¨æç¤ºé€‰æ‹©åˆé€‚çš„ç›®å½•ã€‚**

ä¸Šè¿°æˆ‘ä»¬åˆ›å»ºäº†è‡ªå®šä¹‰çš„æ’ä»¶å®ç°ç±»ï¼Œç°åœ¨å°±å»æ”¹ä¸€ä¸‹æˆ‘ä»¬çš„ `build.gradle` æ–‡ä»¶ï¼Œå¢åŠ ä¸‹è¿°ä»£ç ï¼š

```groovy
//java-gradleæ’ä»¶
apply plugin: 'java-gradle-plugin'
...

//æœ¬åœ°ä¾èµ–æ’ä»¶æ—¶ä½¿ç”¨
gradlePlugin {
    plugins {
        //æ’ä»¶å,æ¯ä¸€ä¸ªæ’ä»¶éƒ½å¯ä»¥æœ‰
        buildSrcTestPlugin {
        		// ä½ çš„æ’ä»¶idï¼Œå¤–éƒ¨é¡¹ç›®å¼•ç”¨æ—¶éœ€è¦
            id = 'com.petterp.gradle.buildSrc'
            // æ’ä»¶çš„å…·ä½“å®ç°ç±»
            implementationClass = 'com.petterp.gradle.BuildSrcGradlePlugin'
        }
      	//ç¬¬äºŒä¸ªæ’ä»¶
//        test2Plugin {
//            id = xxx
//            implementationClass = xxx
//        }
    }
}
```

æ”¹å®Œä¹‹åï¼Œç„¶ååœ¨æˆ‘ä»¬çš„app-build.gradle(å…·ä½“å–å†³äºä½ çš„ä½¿ç”¨ä½ç½®)ä¸­è¿›è¡Œä¾èµ–å¼•å…¥å³å¯ï¼š

![image-20220130122223386](https://tva1.sinaimg.cn/large/008i3skNly1gyvkzbpkyfj32ko0i8n1c.jpg)

åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ˜¯ä¸æ˜¯è¶…ç®€å•ï¼Œå¦‚æœä½ æœè¿‡è€çš„æ•™ç¨‹ï¼Œä½ ä¼šå‘ç°ä½ éœ€è¦ **æ‰‹åŠ¨åˆ›å»ºresourceå³META-xxxç­‰ç­‰** ã€‚

å…¶å®å¹¶ä¸æ˜¯æˆ‘ä»¬æ²¡æœ‰åˆ›å»ºï¼Œè€Œæ˜¯æˆ‘ä»¬ä½¿ç”¨çš„ `java-gradle-plugin` æ’ä»¶ä¼šè‡ªåŠ¨åˆ›å»ºï¼Œå¹¶ä¸”ä»¥ `api` çš„æ–¹å¼å¼•å…¥ **gradleApi()** ,ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬å°†ä¸Šè¿°çš„æ­¥éª¤å®ç°ã€‚å…·ä½“æœ€ç»ˆç”Ÿæˆåœ¨è¿™é‡Œï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

<img src="https://tva1.sinaimg.cn/large/008i3skNly1gyvl34b4mjj30q60ioq3r.jpg" alt="image-20220130122602719" style="zoom:33%;" />

---

### Standalone project

ä¸Šé¢çš„ä¸¤ç§æ–¹å¼åªèƒ½åœ¨å½“å‰é¡¹ç›®ä¸­è¿›è¡Œä½¿ç”¨ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦åœ¨å…¶ä»–é¡¹ç›®ä¸­ä½¿ç”¨ï¼Œæ­¤æ—¶ä¸€èˆ¬æˆ‘ä»¬ä¼šå°†æ’ä»¶å‘å¸ƒåˆ° `Maven` ä¸Šï¼Œä¸å…¶ä»–äººè¿›è¡Œå…±äº«ï¼Œè¿™ä¹Ÿæ˜¯å¼€å‘æ’ä»¶æœ€å¸¸ç”¨çš„ä¸€ç§æ–¹å¼äº†,æœ¬ç¯‡ä¼šä¸Šä¼ åˆ° `JitPack` ä¸Šã€‚

> ç¤ºä¾‹ä»£ç ï¼š[standlone](https://github.com/Petterpx/GradlePluginSImple/tree/main/stand-gradle-plugin)

æˆ‘ä»¬å¤åˆ¶ç²˜è´´ä¸Šé¢æ•™ç¨‹é‡Œçš„ **buildSrc** åŒ…ï¼Œå¹¶å¯¹å…¶è¿›è¡Œæ”¹åå¦‚ä¸‹ï¼Œæ¯”å¦‚æ”¹ä¸º `stand-gradle-plugin` ,ç„¶ååœ¨æˆ‘ä»¬çš„é¡¹ç›® `settings.build` ä¸­å¼•å…¥æ­¤modelï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

<img src="https://tva1.sinaimg.cn/large/008i3skNly1gyvosw0au3j31xi0u00xk.jpg" alt="image-20220130143436155" style="zoom:50%;" />

çœ‹ç€å¥½åƒè¿‡äºç®€å•äº†ç‚¹ï¼Œä¹Ÿæ²¡å•¥ä¸åŒï¼Œä½ å¯èƒ½ä¼šæƒ³ï¼Œé‚£è¿™æ ·çš„è¯ï¼Œé‚£ `buildSrc` çš„ç”¨å¤„æ˜¯å•¥ï¼Ÿåæ­£ä¼¼ä¹å•¥åå­—éƒ½å¯ä»¥å•Šï¼Ÿ

æˆ‘ä»¬å…ˆæ”¹ä¸€ä¸‹ **stand-gradle-plugin** çš„ `æ’ä»¶id` ï¼ŒåŠç›¸åº”çš„ `æ’ä»¶å®ç°ç±»ç±»å` ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

![image-20220130143837496](https://tva1.sinaimg.cn/large/008i3skNly1gyvox2pcvqj321u0hs0v8.jpg)

ç„¶åç›´æ¥å»app-modelä¸­è¿›è¡Œå¼•å…¥ï¼Œæ­¤æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿ

<img src="https://tva1.sinaimg.cn/large/008i3skNly1gyvp0fll5ij31qe0u078t.jpg" alt="image-20220130144151276" style="zoom:50%;" />

æç¤ºæ‰¾ä¸åˆ°è¿™ä¸ªæ’ä»¶ï¼Œä¸ºä»€ä¹ˆï¼Ÿæˆ‘ä¸æ˜¯åœ¨ `settings.gradle` ä¸­å¼•å…¥äº†å—ï¼Ÿ

æˆ‘ä»¬åœ¨æœ€ä¸Šé¢è¯´è¿‡äº†ï¼Œ`buildSrc` æœ¬èº«æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„é¡¹ç›®ï¼Œ**Gradle** ä¼šè‡ªåŠ¨ç¼–è¯‘å¹¶å¼•å…¥ã€‚è€Œå…¶ä»–æ’ä»¶ï¼Œå¦‚æœæ²¡æœ‰é‡‡ç”¨ `maven` çš„æ–¹å¼å¼•å…¥ï¼Œå°±éœ€è¦å•ç‹¬é…ç½®äº†ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

æˆ‘ä»¬æ›´æ”¹ä¸€ä¸‹ `settings.gradle` æ–‡ä»¶ï¼š

```groovy
includeBuild('stand-gradle-plugin')
```

æ›´æ”¹ `é¡¹ç›®æ ¹build.gradle`:

```groovy
plugins {
    ...
    id 'com.petterp.gradle.stand' apply false
}
```

é‡æ–°syncå°±ä¸ä¼šæŠ¥é”™äº†ï¼Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

<img src="https://tva1.sinaimg.cn/large/008i3skNly1gyvpmh4alxj31800akaav.jpg" alt="image-20220130150302326"  />

è¿™å…¶å®å°±ç›¸å½“äºæˆ‘ä»¬ä½¿ç”¨äº†æœ¬åœ°çš„ä¸€ä¸ªæ’ä»¶ï¼Œå¦‚æœä½ ä½¿ç”¨è¿‡å¤åˆæ„å»ºå»é…ç½®è¿‡ä½ çš„é¡¹ç›®ä¾èµ–é…ç½®ï¼Œå¯èƒ½å¯¹è¿™ç§æ–¹å¼å°±éå¸¸ç†Ÿæ‚‰äº†ã€‚

## ä¸Šä¼ åˆ°JitPackä¸­

ä¸€èˆ¬è€Œè¨€ï¼Œæˆ‘ä»¬ä¼šå°†æ’ä»¶ä¸Šä¼ åˆ° `Maven` ä¸Šï¼Œä¾¿äºè·¨é¡¹ç›®ä½¿ç”¨ã€‚æˆ‘ä»¬ä»¥ `Standalone Project` è¿™ç§æ–¹å¼ä¸ºä¾‹ï¼Œæ›´æ”¹ **Standalone** æ–¹å¼ä¸­çš„`build.gradle`ï¼Œå¦‚ä¸‹æ‰€ç¤º,å¢åŠ ä¸‹åˆ—ä»£ç ï¼š

> ç¤ºä¾‹ä»£ç ï¼š[stabdlobe-build.gradle](https://github.com/Petterpx/GradlePluginSImple/blob/main/stand-gradle-plugin/build.gradle)

```groovy
apply plugin: 'maven-publish'

// ç»„åï¼Œå¯ä»¥ç†è§£ä¸ºæ’ä»¶åœ¨é‚£ä¸ªåˆ†ç»„ä¸‹æ”¾ç€ï¼Œæœ€ç»ˆæ˜¯ä¸€ä¸ªæ–‡ä»¶å¤¹
// com/petterp/gradle/plugins/xxx
group = 'com.petterp.gradle'
// æè¿°
description = 'è¿™æ˜¯ä¸€ä¸ªç‹¬ç«‹æ’ä»¶'
// ç‰ˆæœ¬å·
version = '1.0.0'

sourceCompatibility = JavaVersion.VERSION_11
publishing {
    publications {
        maven(MavenPublication) {
          	// ç‰ˆæœ¬idï¼Œæœ€ç»ˆä¼šæ ¹æ®è¿™ä¸ªid-versionç”Ÿæˆç›¸åº”çš„æ’ä»¶
            artifactId = 'com.petterp.gradle.plugin'
            from components.java
        }
    }
   	
    repositories {
        maven {
            // ç”Ÿæˆçš„æ’ä»¶ä½ç½®
            url = uri('../repo')
        }
    }
}
```

æ›´æ”¹settings.gradleä¸­æ’ä»¶ä¾èµ–çš„æ–¹å¼ä¸º

```groovy
include ':stand-gradle-plugin'
```

ç„¶ååœ¨å‘½ä»¤è¡Œæ‰§è¡Œï¼š`gradlew publish`

æ­¤æ—¶æˆ‘ä»¬çš„é¡¹ç›®é‡Œå°±ä¼šå¤šå‡ºä¸€ä¸ª `repo` çš„æ–‡ä»¶å¤¹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¿™å°±æ˜¯æˆ‘ä»¬æœ€ç»ˆæ‰“åŒ…å¥½çš„æ’ä»¶åŒ…ã€‚

![image-20220130170438979](https://tva1.sinaimg.cn/large/008i3skNly1gyvt502535j31im0c0q4v.jpg)

æ¥ä¸‹æ¥å» github æ‰“ Tag,å¹¶æ‰“å¼€ [Jitpack](https://jitpack.io/) ç½‘ç«™ï¼Œæœç´¢æˆ‘ä»¬çš„é¡¹ç›®åç§°ï¼Œè¿›è¡Œæ„å»ºã€‚

![image-20220208085127886](https://tva1.sinaimg.cn/large/008i3skNly1gz5tgmo62oj30y60egdgt.jpg)

å®Œæˆåæˆ‘ä»¬å°±å¯ä»¥åœ¨é¡¹ç›®ä¸­è¿›è¡Œå¼•ç”¨äº†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![image-20220207115147019](https://tva1.sinaimg.cn/large/008i3skNly1gz4t1z9mkwj318w0du75f.jpg)

å› ä¸ºæˆ‘ä»¬ç”Ÿæˆçš„æ˜¯æ’ä»¶ï¼Œæ‰€ä»¥ç›¸åº”çš„ä¾èµ–æ–¹å¼æ”¹ä¸º `classpath`

```groovy
classpath "com.github.Petterpx:GradlePluginSImple:1.0.0"
```

ç„¶ååœ¨ç›¸åº”çš„ model é‡Œå¼•å…¥å³å¯

```groovy
plugins {
    ...
    id 'com.petterp.gradle.stand'
}
```

è¿™é‡Œä¸ºæ­¢ï¼Œä¸€ä¸ªç®€å•çš„æ’ä»¶å°±ç®—åˆ›å»ºå®Œæˆäº†ã€‚

## å‚è€ƒ

- [Gradleæ–‡æ¡£-å¼€å‘è‡ªå®šä¹‰Gradleæ’ä»¶](https://docs.gradle.org/current/userguide/custom_plugins.html)
- [Androidæ–‡æ¡£-ä½¿ç”¨ Maven Publish æ’ä»¶](https://developer.android.com/studio/build/maven-publish-plugin?hl=zh-cn)
- [è‡ªå®šä¹‰Android Gradleæ’ä»¶(Kotlin)](https://apon.me/2021/02/24/%E8%87%AA%E5%AE%9A%E4%B9%89Android-Gradle%E6%8F%92%E4%BB%B6-Kotlin-%E4%B9%8B%E4%B8%80-Hello-World/)

## ç›¸å…³æ–‡ç« 

å¾€æœŸ `Gradle` ç›¸å…³æ–‡ç« å¦‚ä¸‹ï¼š

- [å“ªæ€•ä¸å­¦Gradle,è¿™äº›å¸¸è§æ“ä½œï¼Œä½ ä¹Ÿå€¼å¾—æŒæ¡](https://juejin.cn/post/7053985196906905636)
- [GradleåŸºç¡€|è‡ªå®šä¹‰æ’ä»¶å¹¶ä¸Šä¼ åˆ°JitPack](https://juejin.cn/post/7062141046255255583)



> æˆ‘æ˜¯Petterp,ä¸€ä¸ªä¸‰æµå¼€å‘ï¼Œå¦‚æœæœ¬æ–‡å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œæ¬¢è¿ç‚¹èµæ”¯æŒã€‚